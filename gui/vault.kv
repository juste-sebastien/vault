#:kivy 2.1.0

<AppScreenManager>:
    id: app_screen_manager
    ConsultScreen:
    AddScreen:
    GenerateScreen:


<LoginScreen>:
    name: "login"
    radius: [25, 0, 0, 0]
    BoxLayout:
        orientation: "vertical"
        padding: "10dp", 0, "10dp", "15dp"
        spacing: "10dp"
        Image:
            source: "./img/logo.png"
        Widget:
        MDTextField:
            id: login
            mode: "line"
            hint_text: "Username"
            icon_right: "account"
            color: 1, 0, 0, 1
            size_hint: 0.8, None
            multiline: False
            write_tab: False
            height: "30dp"
            pos_hint: {"center_x": 0.5}
        MDTextField:
            id: pwd
            mode: "line"
            icon_right: "eye-off"
            hint_text: "Password"
            size_hint: 0.8, None
            multiline: False
            height: "30dp"
            pos_hint: {"center_x": 0.5, "top": 1}
            password: True
            on_text_validate: root.on_click(login.text, pwd.text)
        Widget:
        MDRoundFlatButton:
            text: "Connect"
            size_hint: 0.5, 0.5
            on_press: root.on_click(login.text, pwd.text)
            pos_hint: {"center_x": 0.5}
        MDRoundFlatButton:
            text: "Clear"
            size_hint: 0.35, 0.5
            on_press: root.clear()
            pos_hint: {"center_x": 0.5}


<WelcomeScreen>:
    name: "welcome"
    radius: [25, 0, 0, 0]
    GridLayout:
        cols: 1
        rows: 3
        padding: "20dp"
        Logo:
        MDLabel:
            text_size: self.width, None
            theme_text_color: "Custom"
            text_color: 0.89, 0.61, 0.29, 1
            text: root.print_usages_warns()
            halign: "justify"
        BoxLayout:
            size_hint: root.width, None
            height: "40dp"
            spacing: "5dp"
            MDRectangleFlatIconButton:
                id: consult
                text: "Consult"
                icon: "archive-eye-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: add
                text: "Add"
                icon: "archive-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: generate
                text: "Generate"
                icon: "shield-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: logout
                text: "Logout"
                icon: "logout"
                on_press: app.change_screen(widget=self, screen=root)


<ConsultScreen>:
    name: "consult"
    on_pre_enter: self.get_list_account()
    canvas.before:
        Rectangle:
            source: "./img/black_sofa.png"
            size: root.width, root.height
            pos: self.pos
    GridLayout:
        cols: 1
        padding: "20dp"
        Logo:
        GridLayout:
            cols: 1
            id:consult_grid
        BoxLayout:
            size_hint: 1, None
            height: "40dp"
            spacing: "5dp"
            id: navbar
            MDRectangleFlatIconButton:
                id: consult
                text: "Consult"
                icon: "archive-eye-outline"
                on_press: app.change_screen(widget=self, screen=root)

            MDRectangleFlatIconButton:
                id: add
                text: "Add"
                icon: "archive-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: generate
                text: "Generate"
                icon: "shield-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: logout
                text: "Logout"
                icon: "logout"
                on_press: app.change_screen(widget=self, screen=root)


<AddScreen>:
    name: "add"
    canvas.before:
        Rectangle:
            source: "./img/black_sofa.png"
            size: root.width, root.height
            pos: self.pos
    GridLayout:
        cols: 1
        rows: 5
        padding: "20dp"
        Logo:
            pos_hint: {"center_x": dp(20), "center_y": root.height - dp(20)}
        GridLayout:
            cols: 1
            MDTextField:
                hint_text: "Name"
                require: True
                size_hint: 1, None
                height: dp(40)
            MDTextField:
                hint_text: "Login"
                require: True
                size_hint: 1, None
                height: dp(40)
            MDTextField:
                hint_text: "Password"
                require: True
                password: True
                size_hint: 1, None
                height: dp(40)
            MDTextField:
                hint_text: "Url"
                size_hint: 1, None
                height: dp(40)
            MDRectangleFlatIconButton:
                text: "Add to my Vault"
                size_hint: 0.2, None
                height: dp(40)
                pos_hint: {"center_x": 0.5}
            Widget:
        BoxLayout:
            size_hint: 1, None
            height: "40dp"
            spacing: "5dp"
            MDRectangleFlatIconButton:
                id: consult
                text: "Consult"
                icon: "archive-eye-outline"
                on_press: app.change_screen(widget=self, screen=root)

            MDRectangleFlatIconButton:
                id: add
                text: "Add"
                icon: "archive-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: generate
                text: "Generate"
                icon: "shield-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: logout
                icon: "logout"
                text: "Logout"
                on_press: app.change_screen(widget=self, screen=root)

<GenerateScreen>:
    name: "generate"
    canvas.before:
        Rectangle:
            source: "./img/black_sofa.png"
            size: root.width, root.height
            pos: self.pos
    GridLayout:
        cols: 1
        rows: 5
        padding: "20dp"
        Logo:
            pos_hint: {"center_x": dp(20), "center_y": root.height - dp(20)}
        BoxLayout:
            orientation: "vertical"
            MDLabel:
                bold: True
                theme_text_color: "Custom"
                text: "Choose length:"
            MDSlider:
                id: pwd_length
                min: 8
                max: 32
                value: 12
                hint: True
        GridLayout:
            cols: 2
            CheckBox:
                name: "alphabet"
                size_hint: None, 1/3
                color: 1, 1, 0, 1
                width: "60dp"
                active: True
                on_active: root.add_to_list(self)
            MDLabel:
                bold: True
                theme_text_color: "Custom"
                text: "include letters from a to z"
            CheckBox:
                name: "digits"
                size_hint: None, 1/3
                color: 1, 1, 0, 1
                width: "60dp"
                active: False
                on_active: root.add_digits_to_list(self)
            MDLabel:
                bold: True
                theme_text_color: "Custom"
                text: "include digits from 0 to 9"
            CheckBox:
                name: "spec_char"
                size_hint: None, 1/3
                color: 1, 1, 0, 1
                width: "60dp"
                active: False
                on_active: root.add_spec_to_list(self)
            MDLabel:
                bold: True
                theme_text_color: "Custom"
                text: "include !#$%&*+-./:;<=>?@\."
        BoxLayout:
            orientation: "vertical"
            spacing: "5dp"
            size_hint: 0.5, 0.5
            MDRectangleFlatIconButton:
                id: generate_button
                text: "Generate"
                on_press: root.do_generate(pwd_length)
                size_hint: 0.5, 0.5
                pos_hint: {"center_x": 0.5}
            MDLabel:
                bold: True
                theme_text_color: "Custom"
                text: root.pwd
        BoxLayout:
            size_hint: 1, None
            height: "40dp"
            spacing: "5dp"
            MDRectangleFlatIconButton:
                id: consult
                text: "Consult"
                icon: "archive-eye-outline"
                on_press: app.change_screen(widget=self, screen=root)

            MDRectangleFlatIconButton:
                id: add
                text: "Add"
                icon: "archive-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: generate
                text: "Generate"
                icon: "shield-edit-outline"
                on_press: app.change_screen(widget=self, screen=root)
            MDRectangleFlatIconButton:
                id: logout
                icon: "logout"
                text: "Logout"
                on_press: app.change_screen(widget=self, screen=root)


<Logo@BoxLayout>:
    size_hint: None, None
    height: dp(40)
    width: dp(40)

    Image:
        source: "./img/logo.png"
        keep_ratio: True


<AppScreen>:

    MDBottomNavigation:
        #panel_color: "#eeeaea"
        selected_color_background: "orange"
        text_color_active: "lightgrey"


        MDBottomNavigationItem:
            name: 'consult'
            text: 'Consult'
            icon: 'archive-eye-outline'
            BoxLayout:
                size_hint: 1, None
                height: root.height / 10
                padding: dp(20)
                pos_hint: {"center_x": 0.5, "center_y": 0.9}
                MDIconButton:
                    icon: "magnify"
                    pos_hint: {"center_x": self.width / 3, "center_y": 0.5}
                    on_press: root.search(research.text)
                MDTextField:
                    id: research
                    hint_text: "Research"
                    helper_text: "Type the name of the account"
            Carousel:
                id: carousel_card
                MD3Card:
                    orientation: "vertical"
                    line_color: (0.2, 0.2, 0.2, 0.8)
                    style: "elevated"
                    padding: dp(4)
                    size_hint: (0.6, 0.6)
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}
                    GridLayout:
                        cols: 1
                        MDRelativeLayout:
                            md_bg_color: 0.3, 0.3, 0.3, 1
                            size_hint: 1, 0.33
                            MDLabel:
                                id: card_name
                                text: root.card_name
                                font_size: sp(20)
                                #padding: (0, dp(5))

                                pos_hint: {"center_x": 0.5, "center_y": 0.5}
                                halign: "center"
                        MDGridLayout:
                            id: card_core
                            cols: 2
                            row_force_default: True
                            row_default_height: dp(40)
                            padding: (dp(10), 0)
                            MDLabel:
                                text: "Login"
                            MDLabel:
                                id: card_login_label
                                text: root.card_login
                            MDLabel:
                                text: "Password"
                            BoxLayout:
                                MDLabel:
                                    id: card_pwd_label
                                    text: root.card_pwd
                                MDIconButton:
                                    id: card_pwd_button
                                    icon: "eye-off-outline"
                                    icon_size: sp(16)
                                    pos_hint: {"center_x": 0.9,"center_y": 0.5}
                                    on_press: root.reveale_pwd(card_pwd_label, card_pwd_button)
                            MDLabel:
                                text: "Url"
                                size_hint: 1, None
                                height: dp(40)
                        MDLabel:
                            text: root.card_url
                            valign: "top"
                        Widget:

                    MDRelativeLayout:
                        size_hint: 1, None
                        height: dp(50)
                        MDIconButton:
                            id: trash_id
                            icon: "delete-outline"
                            on_press: root.remove()
                            pos_hint: {"center_x": 0.33}
                        MDIconButton:
                            id: refresh_id
                            icon: "refresh"
                            on_press: root.refresh()
                            pos_hint: {"center_x": 0.66}
                MD3Card:
                    orientation: "vertical"
                    line_color: (0.2, 0.2, 0.2, 0.8)
                    style: "elevated"
                    padding: dp(4)
                    size_hint: (0.6, 0.6)
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}
                    GridLayout:
                        cols: 1
                        MDRelativeLayout:
                            md_bg_color: 0.3, 0.3, 0.3, 1
                            size_hint: 1, 0.33
                            MDLabel:
                                id: card_name
                                text: root.card_name
                                font_size: sp(20)
                                #padding: (0, dp(5))

                                pos_hint: {"center_x": 0.5, "center_y": 0.5}
                                halign: "center"
                        MDGridLayout:
                            id: card_core
                            cols: 2
                            row_force_default: True
                            row_default_height: dp(40)
                            padding: (dp(10), 0)
                            MDLabel:
                                text: "Login"
                            MDLabel:
                                id: card_login_label
                                text: root.card_login
                            MDLabel:
                                text: "Password"
                            BoxLayout:
                                MDLabel:
                                    id: card_pwd_label
                                    text: root.card_pwd
                                MDIconButton:
                                    id: card_pwd_button
                                    icon: "eye-off-outline"
                                    icon_size: sp(16)
                                    pos_hint: {"center_x": 0.9,"center_y": 0.5}
                                    on_press: root.reveale_pwd(card_pwd_label, card_pwd_button)
                            MDLabel:
                                text: "Url"
                                size_hint: 1, None
                                height: dp(40)
                        MDLabel:
                            text: root.card_url
                            valign: "top"
                        Widget:

                    MDRelativeLayout:
                        size_hint: 1, None
                        height: dp(50)
                        MDIconButton:
                            id: trash_id
                            icon: "delete-outline"
                            on_press: root.remove()
                            pos_hint: {"center_x": 0.33}
                        MDIconButton:
                            id: refresh_id
                            icon: "refresh"
                            on_press: root.refresh()
                            pos_hint: {"center_x": 0.66}


        MDBottomNavigationItem:
            name: 'add'
            text: 'Add'
            icon: 'archive-edit-outline'
            GridLayout:
                cols: 1
                padding: dp(20)
                MDTextField:
                    hint_text: "Name"
                    require: True
                    size_hint: 1, None
                    height: dp(40)
                MDTextField:
                    hint_text: "Login"
                    require: True
                    size_hint: 1, None
                    height: dp(40)
                MDTextField:
                    hint_text: "Password"
                    require: True
                    password: True
                    size_hint: 1, None
                    height: dp(40)
                MDTextField:
                    hint_text: "Url"
                    size_hint: 1, None
                    height: dp(40)
                MDRectangleFlatIconButton:
                    text: "Add to my Vault"
                    size_hint: 0.2, None
                    height: dp(40)
                    pos_hint: {"center_x": 0.5}


        MDBottomNavigationItem:
            name: 'generate'
            text: 'Generate'
            icon: 'shield-edit-outline'
            BoxLayout:
                orientation: "vertical"
                padding: dp(20)
                BoxLayout:
                    orientation: "vertical"
                    size_hint: 1, None
                    height: dp(60)
                    MDLabel:
                        bold: True
                        theme_text_color: "Custom"
                        text: "Choose length:"
                    MDSlider:
                        id: pwd_length
                        min: 8
                        max: 32
                        value: 12
                        hint: True
                GridLayout:
                    cols: 2
                    row_force_default: True
                    row_default_height: dp(40)
                    padding: dp(20)
                    CheckBox:
                        name: "alphabet"
                        size_hint: None, 1/3
                        color: 1, 1, 0, 1
                        width: "60dp"
                        active: True
                        on_active: root.add_to_list(self)
                    MDLabel:
                        bold: True
                        theme_text_color: "Custom"
                        text: "include letters from a to z"
                    CheckBox:
                        name: "digits"
                        size_hint: None, 1/3
                        color: 1, 1, 0, 1
                        width: "60dp"
                        active: False
                        on_active: root.add_digits_to_list(self)
                    MDLabel:
                        bold: True
                        theme_text_color: "Custom"
                        text: "include digits from 0 to 9"
                    CheckBox:
                        name: "spec_char"
                        size_hint: None, 1/3
                        color: 1, 1, 0, 1
                        width: "60dp"
                        active: False
                        on_active: root.add_spec_to_list(self)
                    MDLabel:
                        bold: True
                        theme_text_color: "Custom"
                        text: "include !#$%&*+-./:;<=>?@\."
                BoxLayout:
                    orientation: "vertical"
                    spacing: dp(5)
                    MDRectangleFlatIconButton:
                        id: generate_button
                        text: "Generate"
                        on_press: root.do_generate(pwd_length)
                        size_hint: 0.5, 0.3
                        pos_hint: {"center_x": 0.5}
                    MDLabel:
                        bold: True
                        theme_text_color: "Custom"
                        text: root.pwd
                        halign: "center"
                        font_size: sp(20)


        MDBottomNavigationItem:
            name: 'logout'
            text: 'Logout'
            icon: 'logout'
            on_tab_press: root.save()
            id: logout_item